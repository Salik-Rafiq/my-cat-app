(this["webpackJsonpmy-cat-app"]=this["webpackJsonpmy-cat-app"]||[]).push([[0],{107:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(16),s=n.n(r),i=(n(77),n(5)),u=(n(78),n(119)),o=n(118),l=n(70),d=n(123),j=n(124),b=n(113),f=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(a.useState)(e),n=Object(i.a)(t,2),c=n[0],r=n[1],s=Object(a.useCallback)((function(){return r((function(e){return!e}))}),[]);return[c,s,s]},p=n(9),h=n.n(p),O=n(12),x=n(112),v=n(120),m=n(122),g=n(114),y=n(32),C=n(33),k={CATAPI_BASE:"https://api.thecatapi.com/v1/",CATAPI_KEY:"468603ca-3623-444c-8d4b-a569132d620c",subID:"SalikRaf-101",PAGE_LIMIT:10},w=n(22),S=n.n(w);S.a.defaults.headers.common["x-api-key"]=k.CATAPI_KEY;var A=function(){function e(){Object(y.a)(this,e)}return Object(C.a)(e,null,[{key:"searchCats",value:function(){var e=Object(O.a)(h.a.mark((function e(){var t,n,a,c,r,s,i,u,o,l,d=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:{},n=t.limit,a=void 0===n?9:n,c=t.page,r=void 0===c?0:c,s=t.order,i=void 0===s?"asc":s,u=t.breedId,o=void 0===u?"":u,l="".concat(k.CATAPI_BASE,"images/search/?limit=").concat(a,"&page=").concat(r,"&order=").concat(i,"&breed_id=").concat(o),e.abrupt("return",S.a.get(l));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getSingleCat",value:function(){var e=Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(k.CATAPI_BASE,"images/search/"),e.abrupt("return",S.a.get(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"sendCatVote",value:function(){var e=Object(O.a)(h.a.mark((function e(t,n){var a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={image_id:t,value:n,sub_id:k.subID},c="".concat(k.CATAPI_BASE,"votes"),e.abrupt("return",S.a.post(c,a));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"uploadCatImage",value:function(){var e=Object(O.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("file",t),a="".concat(k.CATAPI_BASE,"images/upload"),e.abrupt("return",S.a.post(a,n,{headers:{"content-type":"multipart/form-data"}}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBreeds",value:function(){var e=Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(k.CATAPI_BASE,"breeds"),e.abrupt("return",S.a.get(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadVotes",value:function(){var e=Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(k.CATAPI_BASE,"votes?limit=5000"),e.abrupt("return",S.a.get(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getMyImages",value:function(){var e=Object(O.a)(h.a.mark((function e(){var t,n=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.length>0&&void 0!==n[0]?n[0]:1,t="".concat(k.CATAPI_BASE,"images?limit=").concat(k.PAGE_LIMIT),e.abrupt("return",S.a.get(t));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),I=A,E=n(1),T=function(){var e=Object(O.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I.uploadCatImage(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(e){var t=e.isOpen,n=e.onClose,c=Object(a.useState)(),r=Object(i.a)(c,2),s=r[0],u=r[1],o=Object(a.useState)(),l=Object(i.a)(o,2),d=l[0],j=l[1],f=Object(a.useState)(),p=Object(i.a)(f,2),h=p[0],O=p[1],y=Object(a.useState)(!1),C=Object(i.a)(y,2),k=C[0],w=C[1],S=Object(a.useRef)(),A=null;if(h&&d){A=Object(E.jsx)(x.a,{variant:function(){switch(d){case 201:return"success";case 400:return"info";case 500:return"danger";default:return"dark"}}(),dismissible:!0,onClose:function(){j(null),O(null)},children:h},"messageAlert")}return Object(E.jsxs)(v.a,{show:t,onHide:n,onShow:function(){S.current.value=null,j(null),O(null),w(!1)},backdrop:!k||"static",children:[Object(E.jsx)(v.a.Header,{closeButton:!k,children:Object(E.jsx)(v.a.Title,{children:"Upload Cat Image"})}),Object(E.jsxs)(v.a.Body,{children:[A,Object(E.jsx)(m.a,{children:Object(E.jsxs)(m.a.Group,{controlId:"catImageFile",children:[Object(E.jsx)(m.a.Label,{children:"Specific a cat image. It will be scanned and if a cat will be added."}),Object(E.jsx)(m.a.Control,{type:"file",ref:S,onChange:function(e){u(e.target.files[0])},disabled:k})]})})]}),Object(E.jsxs)(v.a.Footer,{children:[Object(E.jsx)(b.a,{variant:"secondary",onClick:n,disabled:k,children:"Cancel"}),Object(E.jsxs)(b.a,{variant:"primary",onClick:function(){if(0===!s)return j(1e3),void O("No file specified. Please select a file to upload.");j(null),O(null),w(!0),T(S.current.files[0]).then((function(e){201===e.status&&O("Successfull upload of a cat image!"),j(e.status)})).catch((function(e){j(e.response.status),400===e.response.status?O("Unsuccessfull. Image is either too large or isn't a cat!"):O("Server Error: ".concat(e.message))})).finally((function(){u(null),S.current.value="",w(!1)}))},disabled:!s,children:[k?Object(E.jsx)(g.a,{animation:"border",role:"uploading",className:"mr-2",size:"sm"}):null,"Upload"]})]})]})},B=n(115),P=n.p+"static/media/spinner.72e5fa5c.gif",N=function(e){var t=e.id,n=e.url,c=e.dimensions,r=e.onClick,s=Object(a.useState)(!0),u=Object(i.a)(s,2),o=u[0],l=u[1];Object(a.useEffect)((function(){l(!0)}),[n]);return Object(E.jsxs)("div",{className:"d-block mx-auto",style:{height:c.cy,width:c.cx},children:[Object(E.jsx)(B.a,{src:P,style:{display:o?"block":"none"},className:"mx-auto mt-auto mb-auto"}),Object(E.jsx)(B.a,{src:n,className:"mx-auto mt-auto mb-auto",style:{display:o?"none":"block",maxHeight:c.cy,maxWidth:c.cx,cursor:"pointer",border:"solid 1px #CDCDCD",boxShadow:"5px 5px 5px #1a1a1a"},onLoad:function(){l(!1)},onClick:r})]},t)},F=n(116),L=n(117),V=n(26),D=n(39),U=Object(D.b)("votes/loadVotes",Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.loadVotes();case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))),K=Object(D.c)({name:"vote counts",initialState:{status:"empty",votes:[]},reducers:{registerVote:function(e,t){var n=t.payload,a=e.votes.find((function(e){return e.image_id===n.image_id}));a?a.value+=n.value:e.votes.push(n)}},extraReducers:function(e){e.addCase(U.fulfilled,(function(e,t){e.status="loaded",e.votes=t.payload}))}}),M=K.actions.registerVote,G=K.reducer,R=function(e){var t=e.id,n=e.onClicked,c=void 0===n?null:n,r=e.onSuccess,s=void 0===r?null:r,u=Object(a.useState)(!1),o=Object(i.a)(u,2),l=o[0],d=o[1],j=Object(V.b)(),f=function(){var e=Object(O.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c&&c(),e.prev=1,d(!0),e.next=5,I.sendCatVote(t,n);case 5:j(M({image_id:t,value:n})),s&&s(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),alert("An error occured while voting. Try again");case 12:return e.prev=12,d(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)(b.a,{variant:"success",disabled:l,onClick:function(){return f(1)},children:["Vote Up\xa0",Object(E.jsx)(F.a,{})]}),"\xa0",Object(E.jsxs)(b.a,{disabled:l,variant:"danger",onClick:function(){return f(0)},children:[Object(E.jsx)(L.a,{}),"\xa0Vote Down"]})]})},H=function(e){var t=e.catId,n=Object(V.c)((function(e){return function(e,t){console.log(e);var n=e.votes.find((function(e){return e.image_id===t}));return n?n.value:null}(e.voteCount,t)}));return Object(E.jsxs)("p",{children:["Votes: ",n||"--"]})},Y=function(){var e=Object(a.useState)({url:""}),t=Object(i.a)(e,2),n=t[0],c=t[1],r=Object(V.b)();function s(){I.getSingleCat().then((function(e){c(e.data[0])}))}function u(){s()}return Object(a.useEffect)((function(){r(U())}),[r]),Object(a.useEffect)((function(){s()}),[]),Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(o.a,{children:Object(E.jsx)(l.a,{className:"align-self-center mt-2",children:Object(E.jsx)(N,{id:n.id,url:n.url,onClick:u,dimensions:{cx:"500px",cy:"500px"}})})}),Object(E.jsx)(o.a,{children:Object(E.jsx)(l.a,{children:Object(E.jsx)(H,{catId:n.id})})}),Object(E.jsx)(o.a,{className:"mt-3",children:Object(E.jsx)(l.a,{children:Object(E.jsx)(R,{id:n.id,onClicked:u})})}),Object(E.jsx)(o.a,{children:Object(E.jsx)("h2",{children:"Click on the image to select a random next image"})})]})},J=function(){var e=Object(O.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getBreeds();case 2:return t=e.sent,n=t.data.map((function(e){return{id:e.id,name:e.name}})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(O.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"rand",e.next=3,I.searchCats({breedId:t,order:"rand"});case 3:return n=e.sent,a=n.data.map((function(e){return{id:e.id,url:e.url}})),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],r=Object(a.useRef)(),s=Object(a.useState)([]),u=Object(i.a)(s,2),l=u[0],d=u[1],j=Object(a.useState)(0),b=Object(i.a)(j,2),f=b[0],p=b[1],x=Object(a.useState)(!0),v=Object(i.a)(x,2),g=v[0],y=v[1];Object(a.useEffect)((function(){J().then((function(e){return c(e)})).then((function(){return C(r.current.value)}))}),[]);var C=function(){var e=Object(O.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y(!0),z(r.current.value).then((function(e){p(e.length);for(var t=[],n=[],a=0;a<e.length;a++)a%3===0&&0!==a&&(t.push(n),n=[]),n.push(e[a]);n.length>0&&t.push(n),d(t),y(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=n.map((function(e){return Object(E.jsx)("option",{value:e.id,children:e.name},e.id)}));return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(o.a,{children:Object(E.jsx)(m.a,{children:Object(E.jsxs)(m.a.Group,{children:[Object(E.jsx)(m.a.Label,{children:"Breed"}),Object(E.jsxs)(m.a.Select,{ref:r,onChange:function(){C()},children:[Object(E.jsx)("option",{value:"",children:"All"}),k]}),Object(E.jsx)(m.a.Text,{children:"Change selection to see a specific breed"})]})})}),Object(E.jsxs)(o.a,{className:"justify-content-md-center",children:[Object(E.jsx)(B.a,{src:P,style:{display:g?"block":"none",height:"125px",width:"125px"}}),Object(E.jsx)("table",{className:"table",style:{width:"auto",display:g?"none":"block"},children:Object(E.jsx)("tbody",{children:l.map((function(e){return Object(E.jsx)("tr",{children:e.map((function(e){return Object(E.jsx)("td",{children:Object(E.jsx)(N,{id:e.id,url:e.url,dimensions:{cx:"150px",cy:"150px"}})},e.id)}))},e.reduce((function(e,t){return e.id+t.id}),""))}))})}),Object(E.jsx)("div",{children:Object(E.jsxs)("p",{children:["Total: ",f]})})]})]})},q=n(125),Q=n(121),X=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),s=Object(i.a)(r,2),u=s[0],o=s[1];Object(a.useEffect)((function(){o(!0),I.getMyImages().then((function(e){var t=e.data;c(t),o(!1)}))}),[]);var l=n.map((function(e){var t=Object(q.a)(e.created_at);return Object(E.jsxs)("figure",{children:[Object(E.jsx)(N,{id:e.id,url:e.url,dimensions:{cx:"500px",cy:"500px"}}),Object(E.jsx)("figcaption",{children:Object(Q.a)(t,"ccc d LLLL y")})]},e.id)}));return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("div",{className:"mt-2",children:Object(E.jsx)("h4",{children:"Your last 10 uploads"})}),Object(E.jsxs)("div",{className:"mt-2",children:[Object(E.jsx)(B.a,{src:P,style:{display:u?"block":"none",height:"125px",width:"125px"}}),u?null:l]}),Object(E.jsx)("p",{children:"Todo: add vote counts"})]})};var Z=function(){var e=f(!1),t=Object(i.a)(e,3),n=t[0],a=t[1],c=t[2];return Object(E.jsxs)(u.a,{className:"App text-center",children:[Object(E.jsx)(o.a,{children:Object(E.jsx)(l.a,{className:"align-self-center",children:Object(E.jsx)("h2",{children:"This is a work in progress."})})}),Object(E.jsx)(o.a,{children:Object(E.jsxs)(d.a,{mountOnEnter:!0,children:[Object(E.jsx)(j.a,{eventKey:"vote",title:"Vote",children:Object(E.jsx)(Y,{})}),Object(E.jsx)(j.a,{eventKey:"search",title:"Search",children:Object(E.jsx)(W,{})}),Object(E.jsx)(j.a,{eventKey:"uploads",title:"Uploads",children:Object(E.jsx)(X,{})})]})}),Object(E.jsxs)(o.a,{className:"justify-content-md-center",children:[Object(E.jsx)("hr",{}),Object(E.jsx)(l.a,{children:Object(E.jsx)(b.a,{onClick:a,children:"Upload a Image"})}),Object(E.jsx)(_,{isOpen:n,onClose:c})]})]})},$=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,126)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))},ee=Object(D.a)({reducer:{voteCount:G}});s.a.render(Object(E.jsx)(c.a.StrictMode,{children:Object(E.jsx)(V.a,{store:ee,children:Object(E.jsx)(Z,{})})}),document.getElementById("root")),$()},77:function(e,t,n){},78:function(e,t,n){}},[[107,1,2]]]);
//# sourceMappingURL=main.e5d500a0.chunk.js.map