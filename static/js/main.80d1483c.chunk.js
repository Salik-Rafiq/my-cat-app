(this["webpackJsonpmy-cat-app"]=this["webpackJsonpmy-cat-app"]||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(14),s=n.n(c),i=(n(75),n(6)),u=(n(76),n(116)),o=n(115),l=n(68),d=n(119),j=n(120),b=n(110),f=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(a.useState)(e),n=Object(i.a)(t,2),r=n[0],c=n[1],s=Object(a.useCallback)((function(){return c((function(e){return!e}))}),[]);return[r,s,s]},p=n(8),h=n.n(p),O=n(11),x=n(109),v=n(117),m=n(118),g=n(111),y=n(29),C=n(30),k={CATAPI_BASE:"https://api.thecatapi.com/v1/",CATAPI_KEY:"468603ca-3623-444c-8d4b-a569132d620c",subID:"SalikRaf-101"},w=n(27),S=n.n(w);S.a.defaults.headers.common["x-api-key"]=k.CATAPI_KEY;var A=function(){function e(){Object(y.a)(this,e)}return Object(C.a)(e,null,[{key:"searchCats",value:function(){var e=Object(O.a)(h.a.mark((function e(){var t,n,a,r,c,s,i,u,o,l,d=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:{},n=t.limit,a=void 0===n?9:n,r=t.page,c=void 0===r?0:r,s=t.order,i=void 0===s?"asc":s,u=t.breedId,o=void 0===u?"":u,l="".concat(k.CATAPI_BASE,"images/search/?limit=").concat(a,"&page=").concat(c,"&order=").concat(i,"&breed_id=").concat(o),e.abrupt("return",S.a.get(l));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getSingleCat",value:function(){var e=Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(k.CATAPI_BASE,"images/search/"),e.abrupt("return",S.a.get(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"sendCatVote",value:function(){var e=Object(O.a)(h.a.mark((function e(t,n){var a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={image_id:t,value:n,sub_id:k.subID},r="".concat(k.CATAPI_BASE,"votes"),e.abrupt("return",S.a.post(r,a));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"uploadCatImage",value:function(){var e=Object(O.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("file",t),a="".concat(k.CATAPI_BASE,"images/upload"),e.abrupt("return",S.a.post(a,n,{headers:{"content-type":"multipart/form-data"}}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBreeds",value:function(){var e=Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(k.CATAPI_BASE,"breeds"),e.abrupt("return",S.a.get(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadVotes",value:function(){var e=Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(k.CATAPI_BASE,"votes?limit=5000"),e.abrupt("return",S.a.get(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),I=A,E=n(1),T=function(){var e=Object(O.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I.uploadCatImage(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(e){var t=e.isOpen,n=e.onClose,r=Object(a.useState)(),c=Object(i.a)(r,2),s=c[0],u=c[1],o=Object(a.useState)(),l=Object(i.a)(o,2),d=l[0],j=l[1],f=Object(a.useState)(),p=Object(i.a)(f,2),h=p[0],O=p[1],y=Object(a.useState)(!1),C=Object(i.a)(y,2),k=C[0],w=C[1],S=Object(a.useRef)(),A=null;if(h&&d){A=Object(E.jsx)(x.a,{variant:function(){switch(d){case 201:return"success";case 400:return"info";case 500:return"danger";default:return"dark"}}(),dismissible:!0,onClose:function(){j(null),O(null)},children:h},"messageAlert")}return Object(E.jsxs)(v.a,{show:t,onHide:n,onShow:function(){S.current.value=null,j(null),O(null),w(!1)},backdrop:!k||"static",children:[Object(E.jsx)(v.a.Header,{closeButton:!k,children:Object(E.jsx)(v.a.Title,{children:"Upload Cat Image"})}),Object(E.jsxs)(v.a.Body,{children:[A,Object(E.jsx)(m.a,{children:Object(E.jsxs)(m.a.Group,{controlId:"catImageFile",children:[Object(E.jsx)(m.a.Label,{children:"Specific a cat image. It will be scanned and if a cat will be added."}),Object(E.jsx)(m.a.Control,{type:"file",ref:S,onChange:function(e){u(e.target.files[0])},disabled:k})]})})]}),Object(E.jsxs)(v.a.Footer,{children:[Object(E.jsx)(b.a,{variant:"secondary",onClick:n,disabled:k,children:"Cancel"}),Object(E.jsxs)(b.a,{variant:"primary",onClick:function(){if(0===!s)return j(1e3),void O("No file specified. Please select a file to upload.");j(null),O(null),w(!0),T(S.current.files[0]).then((function(e){201===e.status&&O("Successfull upload of a cat image!"),j(e.status)})).catch((function(e){j(e.response.status),400===e.response.status?O("Unsuccessfull. Image is either too large or isn't a cat!"):O("Server Error: ".concat(e.message))})).finally((function(){u(null),S.current.value="",w(!1)}))},disabled:!s,children:[k?Object(E.jsx)(g.a,{animation:"border",role:"uploading",className:"mr-2",size:"sm"}):null,"Upload"]})]})]})},B=n(112),N=n.p+"static/media/spinner.72e5fa5c.gif",P=function(e){var t=e.id,n=e.url,r=e.dimensions,c=e.onClick,s=Object(a.useState)(!0),u=Object(i.a)(s,2),o=u[0],l=u[1];Object(a.useEffect)((function(){l(!0)}),[n]);return Object(E.jsxs)("div",{className:"d-block mx-auto",style:{height:r.cy,width:r.cx},children:[Object(E.jsx)(B.a,{src:N,style:{display:o?"block":"none"},className:"mx-auto mt-auto mb-auto"}),Object(E.jsx)(B.a,{src:n,className:"mx-auto mt-auto mb-auto",style:{display:o?"none":"block",maxHeight:r.cy,maxWidth:r.cx,cursor:"pointer",border:"solid 1px #CDCDCD",boxShadow:"5px 5px 5px #1a1a1a"},onLoad:function(){l(!1)},onClick:c})]},t)},V=n(113),F=n(114),D=n(23),L=n(37),U=Object(L.b)("votes/loadVotes",Object(O.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.loadVotes();case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))),K=Object(L.c)({name:"vote counts",initialState:{status:"empty",votes:[]},reducers:{registerVote:function(e,t){var n=t.payload,a=e.votes.find((function(e){return e.image_id===n.image_id}));a?a.value+=n.value:e.votes.push(n)}},extraReducers:function(e){e.addCase(U.fulfilled,(function(e,t){e.status="loaded",e.votes=t.payload}))}}),R=K.actions.registerVote,H=K.reducer,G=function(e){var t=e.id,n=e.onSuccess,r=Object(a.useState)(!1),c=Object(i.a)(r,2),s=c[0],u=c[1],o=Object(D.b)(),l=function(){var e=Object(O.a)(h.a.mark((function e(a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u(!0),e.next=4,I.sendCatVote(t,a);case 4:n&&(o(R({image_id:t,value:a})),n()),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),alert("An error occured while voting. Try again");case 10:return e.prev=10,u(!1),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)(b.a,{variant:"success",disabled:s,onClick:function(){return l(1)},children:["Vote Up\xa0",Object(E.jsx)(V.a,{})]}),"\xa0",Object(E.jsxs)(b.a,{disabled:s,variant:"danger",onClick:function(){return l(0)},children:[Object(E.jsx)(F.a,{}),"\xa0Vote Down"]})]})},J=function(e){var t=e.catId,n=Object(D.c)((function(e){return function(e,t){console.log(e);var n=e.votes.find((function(e){return e.image_id===t}));return n?n.value:null}(e.voteCount,t)}));return Object(E.jsxs)("p",{children:["Votes: ",n||"--"]})},Y=function(){var e=Object(a.useState)({url:""}),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(D.b)();function s(){I.getSingleCat().then((function(e){r(e.data[0])}))}function u(){s()}return Object(a.useEffect)((function(){c(U())}),[c]),Object(a.useEffect)((function(){s()}),[]),Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(o.a,{children:Object(E.jsx)(l.a,{className:"align-self-center mt-2",children:Object(E.jsx)(P,{id:n.id,url:n.url,onClick:u,dimensions:{cx:"500px",cy:"500px"}})})}),Object(E.jsx)(o.a,{children:Object(E.jsx)(l.a,{children:Object(E.jsx)(J,{catId:n.id})})}),Object(E.jsx)(o.a,{className:"mt-3",children:Object(E.jsx)(l.a,{children:Object(E.jsx)(G,{id:n.id,onSuccess:u})})}),Object(E.jsx)(o.a,{children:Object(E.jsx)("h2",{children:"Click on the image to select a random next image"})})]})},z=function(){var e=Object(O.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getBreeds();case 2:return t=e.sent,n=t.data.map((function(e){return{id:e.id,name:e.name}})),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(O.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"rand",e.next=3,I.searchCats({breedId:t,order:"rand"});case 3:return n=e.sent,a=n.data.map((function(e){return{id:e.id,url:e.url}})),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(a.useRef)(),s=Object(a.useState)([]),u=Object(i.a)(s,2),l=u[0],d=u[1],j=Object(a.useState)(0),b=Object(i.a)(j,2),f=b[0],p=b[1],x=Object(a.useState)(!0),v=Object(i.a)(x,2),g=v[0],y=v[1];Object(a.useEffect)((function(){z().then((function(e){return r(e)})).then((function(){return C(c.current.value)}))}),[]);var C=function(){var e=Object(O.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y(!0),M(c.current.value).then((function(e){p(e.length);for(var t=[],n=[],a=0;a<e.length;a++)a%3===0&&0!==a&&(t.push(n),n=[]),n.push(e[a]);n.length>0&&t.push(n),d(t),y(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=n.map((function(e){return Object(E.jsx)("option",{value:e.id,children:e.name},e.id)}));return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(o.a,{children:Object(E.jsx)(m.a,{children:Object(E.jsxs)(m.a.Group,{children:[Object(E.jsx)(m.a.Label,{children:"Breed"}),Object(E.jsxs)(m.a.Select,{ref:c,onChange:function(){C()},children:[Object(E.jsx)("option",{value:"",children:"All"}),k]}),Object(E.jsx)(m.a.Text,{children:"Change selection to see a specific breed"})]})})}),Object(E.jsxs)(o.a,{className:"justify-content-md-center",children:[Object(E.jsx)(B.a,{src:N,style:{display:g?"block":"none",height:"125px",width:"125px"}}),Object(E.jsx)("table",{className:"table",style:{width:"auto",display:g?"none":"block"},children:Object(E.jsx)("tbody",{children:l.map((function(e){return Object(E.jsx)("tr",{children:e.map((function(e){return Object(E.jsx)("td",{children:Object(E.jsx)(P,{id:e.id,url:e.url,dimensions:{cx:"150px",cy:"150px"}})},e.id)}))},e.reduce((function(e,t){return e.id+t.id}),""))}))})}),Object(E.jsx)("div",{children:Object(E.jsxs)("p",{children:["Total: ",f]})})]})]})};var q=function(){var e=f(!1),t=Object(i.a)(e,3),n=t[0],a=t[1],r=t[2];return Object(E.jsxs)(u.a,{className:"App text-center",children:[Object(E.jsx)(o.a,{children:Object(E.jsx)(l.a,{className:"align-self-center",children:Object(E.jsx)("h2",{children:"This is a work in progress."})})}),Object(E.jsx)(o.a,{children:Object(E.jsxs)(d.a,{mountOnEnter:!0,children:[Object(E.jsx)(j.a,{eventKey:"vote",title:"Vote",children:Object(E.jsx)(Y,{})}),Object(E.jsx)(j.a,{eventKey:"search",title:"Search",children:Object(E.jsx)(W,{})})]})}),Object(E.jsxs)(o.a,{className:"justify-content-md-center",children:[Object(E.jsx)("hr",{}),Object(E.jsx)(l.a,{children:Object(E.jsx)(b.a,{onClick:a,children:"Upload a Image"})}),Object(E.jsx)(_,{isOpen:n,onClose:r})]})]})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,121)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))},X=Object(L.a)({reducer:{voteCount:H}});s.a.render(Object(E.jsx)(r.a.StrictMode,{children:Object(E.jsx)(D.a,{store:X,children:Object(E.jsx)(q,{})})}),document.getElementById("root")),Q()},75:function(e,t,n){},76:function(e,t,n){}},[[105,1,2]]]);
//# sourceMappingURL=main.80d1483c.chunk.js.map